(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     13866,        361]
NotebookOptionsPosition[     12145,        322]
NotebookOutlinePosition[     12502,        338]
CellTagsIndexPosition[     12459,        335]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{"time", "=", "Now"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"path", "=", 
   RowBox[{"ParentDirectory", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], ",", "2"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.729771288439731*^9, 3.729771293051919*^9}, {
  3.729771365116741*^9, 3.729771365669153*^9}, {3.73011016299809*^9, 
  3.7301101653627796`*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"98932141-cd50-4396-be85-fb4664703b06"],

Cell[BoxData[
 TemplateBox[{RowBox[{"\"Sat 17 Mar 2018 20:47:13\"", 
     StyleBox[
      RowBox[{"\"GMT+\"", "\[InvisibleSpace]", 
        StyleBox["8.`", NumberMarks -> False, StripOnInput -> False]}], 
      FontColor -> GrayLevel[0.5]]}],RowBox[{"DateObject", "[", 
     RowBox[{
       RowBox[{"{", 
         RowBox[{
          "2018", ",", "3", ",", "17", ",", "20", ",", "47", ",", 
           "13.3491282`8.878027857583005"}], "}"}], ",", "\"Instant\"", ",", 
       "\"Gregorian\"", ",", "8.`"}], "]"}]},
  "DateObject",
  Editable->False]], "Output",
 CellChangeTimes->{
  3.729771239366509*^9, {3.7297712932210383`*^9, 3.729771316512967*^9}, 
   3.7297713662981377`*^9, {3.7297720708936195`*^9, 3.7297720818638763`*^9}, 
   3.729772881395602*^9, 3.7297740000728436`*^9, 3.7298475048061686`*^9, 
   3.7299153345365477`*^9, 3.730100394315765*^9, 3.7301004443635335`*^9, {
   3.7301101576373024`*^9, 3.730110171080807*^9}, 3.7301102200083714`*^9, 
   3.730110701011134*^9, 3.7301108115682592`*^9, 3.7301110475790744`*^9, 
   3.7302005412780995`*^9, 3.730268415731284*^9, 3.730268539091544*^9, 
   3.7302692432320347`*^9, 3.7302718272203107`*^9, 3.730275487136284*^9, 
   3.73027874578942*^9, 3.7302788199818945`*^9, 3.7302790478040133`*^9, 
   3.7302792586581364`*^9, 3.7302794884266334`*^9, 3.730279633367139*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"68069740-b404-4a83-915a-fdc8baebebcb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"rawPath", "=", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{"path", ",", "\"\<Packages\>\"", ",", "\"\<__Raw\>\""}], 
     "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"all", "=", 
   RowBox[{"Select", "[", 
    RowBox[{
     RowBox[{"FileNames", "[", 
      RowBox[{"\"\<*\>\"", ",", "rawPath"}], "]"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"StringPart", "[", 
        RowBox[{"#", ",", 
         RowBox[{"-", "1"}]}], "]"}], "==", "\"\<l\>\""}], "&"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"dQ", "=", 
   RowBox[{
    RowBox[{"Or", "@@", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"#", "==", "\"\<\>\""}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"StringPart", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{"1", ",", "2"}], "}"}]}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"\"\<(\>\"", ",", "\"\<*\>\""}], "}"}]}], "&&", 
        RowBox[{
         RowBox[{"StringPart", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "2"}], ",", 
             RowBox[{"-", "1"}]}], "}"}]}], "]"}], "===", 
         RowBox[{"{", 
          RowBox[{"\"\<*\>\"", ",", "\"\<)\>\""}], "}"}]}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<BeginPackage\>\"", ".."}]}], "]"}], "||", 
        RowBox[{"StringContainsQ", "[", 
         RowBox[{"#", ",", 
          RowBox[{"\"\<EndPackage\>\"", ".."}]}], "]"}]}]}], 
      "\[IndentingNewLine]", "}"}]}], "&"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"build", "[", "file_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"mpkg", ",", "name"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"mpkg", "=", 
       RowBox[{"DeleteCases", "[", 
        RowBox[{
         RowBox[{"Import", "[", 
          RowBox[{"file", ",", "\"\<List\>\"", ",", 
           RowBox[{"CharacterEncoding", "\[Rule]", "\"\<UTF8\>\""}]}], "]"}], 
         ",", 
         RowBox[{"_", "?", "dQ"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"name", "=", 
       RowBox[{"FileNameJoin", "@", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"ParentDirectory", "@", "rawPath"}], ",", 
          RowBox[{
           RowBox[{"FileBaseName", "[", "file", "]"}], "<>", "\"\<.m\>\""}]}],
          "}"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"Export", "[", 
       RowBox[{"name", ",", "mpkg", ",", "\"\<List\>\""}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Print", "[", 
       RowBox[{
        RowBox[{"FileBaseName", "[", "file", "]"}], "<>", 
        "\"\< \:521b\:5efa\:5b8c\:6210!\>\""}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}], "//", "Quiet"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"build", "/@", "all"}], ";"}], "//", "TT"}]}], "Input",
 CellChangeTimes->{{3.728461645158337*^9, 3.7284616462603784`*^9}, {
   3.728461684173412*^9, 3.728461686063533*^9}, 3.7284618463375206`*^9, {
   3.7284636989194775`*^9, 3.7284637620755196`*^9}, {3.728463924773369*^9, 
   3.7284640526233063`*^9}, {3.7297712425222225`*^9, 3.7297712884532547`*^9}, 
   3.7297713201977806`*^9, {3.7297714485839005`*^9, 3.729771452282817*^9}, 
   3.72984752747715*^9},
 CellLabel->"In[66]:=",ExpressionUUID->"3177b61e-361d-46d8-a92b-ce796349fc78"],

Cell[CellGroupData[{

Cell[BoxData["\<\"Html2Markdown \:521b\:5efa\:5b8c\:6210!\"\>"], "Print",
 CellChangeTimes->{3.730110171299946*^9, 3.730110220165482*^9, 
  3.7301107011542234`*^9, 3.730110811714361*^9, 3.730111047696144*^9, 
  3.7302005415402856`*^9, 3.730268415993471*^9, 3.7302685392706547`*^9, 
  3.7302692435792804`*^9, 3.7302718273734193`*^9, 3.730275487299384*^9, 
  3.730278745939528*^9, 3.7302788201390038`*^9, 3.7302790479481287`*^9, 
  3.7302792587892294`*^9, 3.7302794885867605`*^9, 3.730279633544266*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[66]:=",ExpressionUUID->"b999d8b0-17dc-4961-a679-\
e6551544385c"],

Cell[BoxData["\<\"ZhihuLinkBackup \:521b\:5efa\:5b8c\:6210!\"\>"], "Print",
 CellChangeTimes->{3.730110171299946*^9, 3.730110220165482*^9, 
  3.7301107011542234`*^9, 3.730110811714361*^9, 3.730111047696144*^9, 
  3.7302005415402856`*^9, 3.730268415993471*^9, 3.7302685392706547`*^9, 
  3.7302692435792804`*^9, 3.7302718273734193`*^9, 3.730275487299384*^9, 
  3.730278745939528*^9, 3.7302788201390038`*^9, 3.7302790479481287`*^9, 
  3.7302792587892294`*^9, 3.7302794885867605`*^9, 3.730279633549267*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[66]:=",ExpressionUUID->"bc010cbe-6abb-4865-9e1e-\
6ed42754fcbc"],

Cell[BoxData["\<\"ZhihuLinkGet \:521b\:5efa\:5b8c\:6210!\"\>"], "Print",
 CellChangeTimes->{3.730110171299946*^9, 3.730110220165482*^9, 
  3.7301107011542234`*^9, 3.730110811714361*^9, 3.730111047696144*^9, 
  3.7302005415402856`*^9, 3.730268415993471*^9, 3.7302685392706547`*^9, 
  3.7302692435792804`*^9, 3.7302718273734193`*^9, 3.730275487299384*^9, 
  3.730278745939528*^9, 3.7302788201390038`*^9, 3.7302790479481287`*^9, 
  3.7302792587892294`*^9, 3.7302794885867605`*^9, 3.7302796336203175`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[66]:=",ExpressionUUID->"f33e71b6-46c6-455c-893f-\
568a2839ee82"],

Cell[BoxData["\<\"ZhihuLinkInit \:521b\:5efa\:5b8c\:6210!\"\>"], "Print",
 CellChangeTimes->{3.730110171299946*^9, 3.730110220165482*^9, 
  3.7301107011542234`*^9, 3.730110811714361*^9, 3.730111047696144*^9, 
  3.7302005415402856`*^9, 3.730268415993471*^9, 3.7302685392706547`*^9, 
  3.7302692435792804`*^9, 3.7302718273734193`*^9, 3.730275487299384*^9, 
  3.730278745939528*^9, 3.7302788201390038`*^9, 3.7302790479481287`*^9, 
  3.7302792587892294`*^9, 3.7302794885867605`*^9, 3.7302796336363287`*^9},
 CellLabel->
  "\:6b63\:5728\:8ba1\:7b97In[66]:=",ExpressionUUID->"38539241-f088-4e37-b280-\
d1195312423d"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU Time: \"\>",
   "EchoLabel"], " ", "0.109375`"}]], "Echo",
 CellChangeTimes->{
  3.730279633639345*^9},ExpressionUUID->"025159c9-de35-4c75-abba-\
75ac8ba66cf2"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"All Time: \"\>",
   "EchoLabel"], " ", "0.17549800954801134`"}]], "Echo",
 CellChangeTimes->{
  3.730279633651342*^9},ExpressionUUID->"b1cc0627-ec30-4bab-b1e3-\
fbcc130138ae"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"info", "=", 
   RowBox[{"FileNameJoin", "@", 
    RowBox[{"{", 
     RowBox[{"path", ",", "\"\<PacletInfo.m\>\""}], "}"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"foo", "=", 
   RowBox[{
    RowBox[{"StringReplace", "[", 
     RowBox[{"#", ",", 
      RowBox[{
       RowBox[{"\"\<.\>\"", "~~", 
        RowBox[{"n", ":", 
         RowBox[{"DigitCharacter", ".."}]}], "~~", "\"\<\\\"\>\""}], 
       "\[RuleDelayed]", 
       RowBox[{"\"\<.\>\"", "~~", 
        RowBox[{"ToString", "[", 
         RowBox[{
          RowBox[{"ToExpression", "[", "n", "]"}], "+", "1"}], "]"}], "~~", 
        "\"\<\\\"\>\""}]}]}], "]"}], "&"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"infoN", "=", 
   RowBox[{"StringReplace", "[", 
    RowBox[{
     RowBox[{"Import", "[", 
      RowBox[{"info", ",", "\"\<String\>\""}], "]"}], ",", 
     RowBox[{
      RowBox[{"\"\<Version\>\"", "~~", "x__", "~~", "\"\<\\\",\>\""}], 
      "\[RuleDelayed]", 
      RowBox[{"\"\<Version\>\"", "~~", 
       RowBox[{"foo", "[", "x", "]"}], "~~", "\"\<\\\",\>\""}]}]}], "]"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{"info", ",", "infoN", ",", "\"\<String\>\""}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"paclet", "=", 
   RowBox[{
    RowBox[{"PackPaclet", "@", "path"}], "//", "TT"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SystemOpen", "[", 
   RowBox[{"DirectoryName", "[", 
    RowBox[{"AbsoluteFileName", "[", "paclet", "]"}], "]"}], "]"}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.7297728895119824`*^9, 3.7297729650171385`*^9}, {
   3.7297730025081434`*^9, 3.72977303691256*^9}, {3.729773139706052*^9, 
   3.729773186893263*^9}, {3.729773561682421*^9, 3.72977356270006*^9}, {
   3.7297737188628263`*^9, 3.7297737946528473`*^9}, {3.729773825999505*^9, 
   3.7297738541097183`*^9}, 3.729847528947226*^9, 3.7301003890139604`*^9, {
   3.7301102831269836`*^9, 3.730110289989846*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"19605adc-92fc-4fd3-8af2-ee3792c7efc5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"CPU Time: \"\>",
   "EchoLabel"], " ", "0.046875`"}]], "Echo",
 CellChangeTimes->{
  3.7302796339685802`*^9},ExpressionUUID->"b746e2fe-95f7-40b2-9112-\
e81204cdf0de"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"All Time: \"\>",
   "EchoLabel"], " ", "0.262128507667194`"}]], "Echo",
 CellChangeTimes->{
  3.73027963398359*^9},ExpressionUUID->"8de4eadf-e701-431c-a73e-5ee38b645380"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Echo", "[", 
   RowBox[{
    RowBox[{"Now", "-", "time"}], ",", "\"\<Time used: \>\""}], "]"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.730101440514496*^9, 3.730101473242628*^9}},
 CellLabel->"In[77]:=",ExpressionUUID->"54c51c65-cf5e-4b3c-a0e9-0bf61c90ab86"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"Time used: \"\>",
   "EchoLabel"], " ", 
  TemplateBox[{"0.6944893000000001`","\"s\"","seconds","\"Seconds\""},
   "Quantity"]}]], "Echo",
 CellChangeTimes->{
  3.730279634960266*^9},ExpressionUUID->"627f3212-fcf9-4181-bda8-\
3e180be94a95"]
}, Open  ]]
},
WindowSize->{775, 872},
WindowMargins->{{183, Automatic}, {-22, Automatic}},
FrontEndVersion->"11.3 for Microsoft Windows (64-bit) (2018\:5e743\:67086\
\:65e5)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 484, 11, 48, "Input",ExpressionUUID->"98932141-cd50-4396-be85-fb4664703b06"],
Cell[1067, 35, 1401, 25, 45, "Output",ExpressionUUID->"68069740-b404-4a83-915a-fdc8baebebcb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2505, 65, 3589, 93, 309, "Input",ExpressionUUID->"3177b61e-361d-46d8-a92b-ce796349fc78"],
Cell[CellGroupData[{
Cell[6119, 162, 608, 9, 22, "Print",ExpressionUUID->"b999d8b0-17dc-4961-a679-e6551544385c"],
Cell[6730, 173, 610, 9, 22, "Print",ExpressionUUID->"bc010cbe-6abb-4865-9e1e-6ed42754fcbc"],
Cell[7343, 184, 609, 9, 22, "Print",ExpressionUUID->"f33e71b6-46c6-455c-893f-568a2839ee82"],
Cell[7955, 195, 610, 9, 22, "Print",ExpressionUUID->"38539241-f088-4e37-b280-d1195312423d"],
Cell[8568, 206, 202, 6, 23, "Echo",ExpressionUUID->"025159c9-de35-4c75-abba-75ac8ba66cf2"],
Cell[8773, 214, 213, 6, 23, "Echo",ExpressionUUID->"b1cc0627-ec30-4bab-b1e3-fbcc130138ae"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[9035, 226, 2029, 53, 181, "Input",ExpressionUUID->"19605adc-92fc-4fd3-8af2-ee3792c7efc5"],
Cell[CellGroupData[{
Cell[11089, 283, 204, 6, 23, "Echo",ExpressionUUID->"b746e2fe-95f7-40b2-9112-e81204cdf0de"],
Cell[11296, 291, 208, 5, 23, "Echo",ExpressionUUID->"8de4eadf-e701-431c-a73e-5ee38b645380"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[11553, 302, 295, 7, 28, "Input",ExpressionUUID->"54c51c65-cf5e-4b3c-a0e9-0bf61c90ab86"],
Cell[11851, 311, 278, 8, 31, "Echo",ExpressionUUID->"627f3212-fcf9-4181-bda8-3e180be94a95"]
}, Open  ]]
}
]
*)

