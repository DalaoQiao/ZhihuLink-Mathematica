Gini::usage="";GiniPlot::usage="";
Begin["`Private`"];
Gini[dt_List]:=With[{sorted=Accumulate[Sort[dt]],n=N@Length[dt]},(2/n)*Mean[MapIndexed[First[#2]-#1&,sorted*(n/Last[sorted])]]];Options[GiniPlot]={Log->True,PlotStyle->{Lighter@Blue,Lighter@Red}};GiniPlot[raw_List,OptionsPattern[]]:=Block[{data=Max[raw]Sort[raw]/Max[Accumulate@raw],l,m,p,fi,li,gini,legend,img},l=Length@data;m=Last@Accumulate@data;fi=Interpolation[Accumulate@data,InterpolationOrder->1];li=Interpolation[{{0,0},{l,m}},InterpolationOrder->1];gini=Row@{Style["\:57fa\:5c3c\:7cfb\:6570: "],Style[#,Blend[{Blue,Red},#/100.],Bold]}&[Round[10000Gini[data]]/100.];legend=Placed[LineLegend[{Lighter@Blue,Lighter@Red},{"\:52b3\:4f26\:5179\:66f2\:7ebf","\:7edd\:5bf9\:306e\:5e73\:7b49"},LegendFunction->"Frame",LegendLayout->"Column",LegendLabel->Placed[gini,Bottom]],If[OptionValue[Log],{{0.8,0.3},{0.5,1}},{{0.25,0.95},{0.5,1}}]];img=If[OptionValue[Log],LogPlot,Plot][{fi[x],li[x]},{x,1,l},Filling->{1->Bottom,2->{1}},PlotLegends->legend,PlotStyle->OptionValue[PlotStyle],AspectRatio->1,ImageSize->320]];
End[];
