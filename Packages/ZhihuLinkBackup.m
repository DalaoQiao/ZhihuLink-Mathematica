ZhihuAnswerBackup::ussage="";ZhihuArticleBackup::ussage="";
Begin["`Private`"];
Options[Answer2MD]={Debug->False,MetaInformation->True};Answer2MD[post_,OptionsPattern[]]:=Block[{md,name},md={"title: "<> post["question","title"],"author: "<>post["author","name"],"date: "<>DateString@FromUnixTime[post["created_time"]],"---",Sequence@@If[OptionValue[MetaInformation],{"url: "<>StringTemplate["https://www.zhihu.com/question/`q`/answer/`a`"][<|"q"->post["question","id"],"a"->post["id"]|>],"last_modify: "<>DateString@FromUnixTime[post["updated_time"]],"author_id: "<>post["author","url_token"],"voteup: "<>ToString@post["voteup_count"],"now_time: "<>DateString@Now,"---"},Nothing],H2MD[post["content"],Module->"Zhihu"]};If[OptionValue[Debug],Return[md],name=StringDelete[StringJoin[post["author","name"],"-",post["question","title"],".md"],{"\:ff1f", "\:ff0c"}];Export[FileNameJoin[{$ZhihuLinkMarkdown,name}],md,"Text"]]];Options[ZhihuAnswerBackup]={MetaInformation->True,Times->True};ZhihuAnswerBackup[id_String,OptionsPattern[]]:=Block[{i=1,n,get,now=Now},Print@Style[Text["\:6b63\:5728\:6293\:53d6 "<>id<>" \:7684\:56de\:7b54"],Blue];get=ZhihuLinkUserAnswer[id,Extension->Min,Save->False];Print@Style[Text["\:5171\:6293\:53d6\:5230 "<>ToString[Length@get]<>" \:4e2a\:56de\:7b54, \:8f6c\:6362\:4e2d....."],Brown];Monitor[Table[Answer2MD[n,MetaInformation->OptionValue[MetaInformation]];i++,{n,get}],Grid[{{Text[Style["Question: ",Darker[Blue,0.66]]],Style[Text[n["question","title"]],Red]},{Text[Style["Progress: ",Darker[Blue,0.66]]],ProgressIndicator[i/Length@get]}},Alignment->Left,Dividers->Center]];If[OptionValue[Times],Echo[Now-now,"Time Used: "]];];Options[Article2MD]={Debug->False,MetaInformation->True};Article2MD[post_,OptionsPattern[]]:=Block[{md,name},md={"title: "<>post["title"],"author: "<>post["author","name"],"date: "<>DateString@FromUnixTime[post["created"]],"---",Sequence@@If[OptionValue[MetaInformation],{"url: "<>post["url"],"last_modify: "<>DateString@FromUnixTime[post["updated"]],"author_id: "<>post["author","url_token"],"vote: "<>ToString@post["voteup_count"],"now_time: "<>DateString@Now,StringJoin["![](",post["image_url"],")"],"---"},Nothing],H2MD[post["content"],Module->"Zhihu"]};If[OptionValue[Debug],Return[md],name=StringDelete[StringJoin[post["author","name"],"-",post["title"],".md"],{"\:ff1f", "\:ff0c"}];Export[FileNameJoin[{$ZhihuLinkMarkdown,name}],md,"Text"]]];Options[ZhihuArticleBackup]={MetaInformation->True,Times->True};ZhihuArticleBackup[id_String,OptionsPattern[]]:=Block[{i=1,n,get,now=Now},Print@Style[Text["\:6b63\:5728\:6293\:53d6 "<>id<>" \:7684\:6587\:7ae0"],Blue];get=ZhihuLinkUserArticle[id,Extension->Min,Save->False];Print@Style[Text["\:5171\:6293\:53d6\:5230 "<>ToString[Length@get]<>" \:7bc7\:6587\:7ae0, \:8f6c\:6362\:4e2d....."],Brown];Monitor[Table[Article2MD[n,MetaInformation->OptionValue[MetaInformation]];i++,{n,get}],Grid[{{Text[Style["Article: ",Darker[Blue,0.66]]],Style[Text[n["title"]],Green]},{Text[Style["Progress: ",Darker[Blue,0.66]]],ProgressIndicator[i/Length@get]}},Alignment->Left,Dividers->Center]];If[OptionValue[Times],Echo[Now-now,"Time Used: "]];];
End[];
